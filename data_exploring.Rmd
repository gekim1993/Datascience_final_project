---
title: "final_project"
author: "Gaeun Kim"
date: "11/20/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
```

```{r}
nyc_res = read_csv("./data/DOHMH_New_York_City_Restaurant_Inspection_Results.csv") %>%
  clean_names()
nyc_res %>% names()

nyc_res %>%
  filter(dba == "MCDONALDS") %>%
  View()
  distinct(camis) 


```

I am trying to match a list of american fastfood restaurants with our data.
I got the list from Wikipedia.
I've only looked into how many mcdonalds I have in my new chain_rest data and the problem is some are written as mcdonald's or mcdonalds or mcdonalds restaurant and so on. So I have lost some when not using regex... Do you have any other ideas? or do you think it's okay to lose some?
```{r}
library(rvest)
library(httr)
chains_html = read_html("https://en.wikipedia.org/wiki/List_of_restaurant_chains_in_the_United_States#Fast-casual")

chain_rest = chains_html %>%
  html_nodes("ul:nth-child(9) li , .jquery-tablesorter tr:nth-child(1) td:nth-child(1)") %>%
  html_text() %>%
  as.tibble()

library(stringr)

chain_rest = 
chain_rest %>%
  mutate(dba = value, 
         dba = str_to_upper(dba)) %>%
  select(dba)

nyc_chain = 
right_join(nyc_res, chain_rest) %>%
  filter(!is.na(camis))

# How many mcdonalds?

nyc_chain %>%
  filter(dba == "MCDONALD'S") %>%
  distinct(camis) 
## 201

nyc_res %>%
  filter(str_detect(dba, regex("^MCDON"))) %>%
  distinct(camis)
## 219 but some are some other restaurants...
```

